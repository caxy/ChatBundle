<form id="chatForm" action="{{ path('cunningsoft_chat_post', {'channel': channel}) }}" method="post">
    <label for="chatMessage">Message</label>
    <input type="text" name="message" id="chatMessage" />
    <input type="submit" value="submit" />
</form>
{% render 'CunningsoftChatBundle:Chat:list' with {'channel': channel} %}
<script type="text/javascript">
$("#chatForm").submit(function() {
    postMessage();
    updateChat();
    return false;
});
function postMessage()
{
    $.post('{{ path('cunningsoft_chat_post', {'channel': channel}) }}', { 'message': $("#chatMessage").val() });
    $("#chatMessage").val('');
}
function updateChat()
{
    if (this.timer)
        clearTimeout(this.timer);

    $.post('{{ path('cunningsoft_chat_list', {'channel': channel}) }}', function(data) {
        $('#chat').html(data);
    });
    this.timer = setTimeout('updateChat()', {{ updateInterval }});
}
updateChat();
</script>
